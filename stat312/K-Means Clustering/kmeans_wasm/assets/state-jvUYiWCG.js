import{o as s}from"./react-7g8sREeT.js";import{wr as l}from"./cells-Dd1FatlG.js";import{t as c}from"./Logger-BkkOJyg0.js";import{u as m}from"./once-8ZDiGGtA.js";function h(e){return{getItem(t,r){try{let a=localStorage.getItem(t);if(!a)return r;let i=JSON.parse(a);return e.fromSerializable(i)}catch(a){return c.warn(`Error getting ${t} from storage`,a),r}},setItem:(t,r)=>{localStorage.setItem(t,JSON.stringify(e.toSerializable(r)))},removeItem:t=>{localStorage.removeItem(t)}}}var u="marimo:ai:chatState:v5";const f=s(null),g=l("marimo:ai:includeOtherCells",!0);function I(e){let t=new Map;for(let[r,a]of e.entries()){if(a.messages.length===0)continue;let i=m(a.messages,n=>n.id);t.set(r,{...a,messages:i})}return t}const o=l(u,{chats:new Map,activeChatId:null},h({toSerializable:e=>({chats:[...I(e.chats).entries()],activeChatId:e.activeChatId}),fromSerializable:e=>({chats:new Map(e.chats),activeChatId:e.activeChatId})})),v=s(e=>{let t=e(o);return t.activeChatId?t.chats.get(t.activeChatId):null},(e,t,r)=>{t(o,a=>({...a,activeChatId:r}))});export{g as i,f as n,o as r,v as t};
