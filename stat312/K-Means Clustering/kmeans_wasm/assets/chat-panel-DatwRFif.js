import{s as ae}from"./chunk-DZLz74EQ.js";import{i as Dt,n as It,r as Ue}from"./react-7g8sREeT.js";import{t as kt}from"./react-BcIddLXZ.js";import{At as Mt,Et as Ft,en as Ot}from"./cells-Dd1FatlG.js";import"./react-dom-D6bRRS5R.js";import{C as Xe,E as Wt,F as Ht,z as et}from"./zod-BEi78Y5d.js";import{n as Te,t as Yt}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-CPNtPV0k.js";import"./isSymbol-D1Vf4s0g.js";import"./_arrayMap-DQI2GUNb.js";import"./toString-pPvo2488.js";import"./toNumber-Bjr00yqN.js";import"./toInteger-Qi6pclEF.js";import"./isArrayLikeObject-CQy5-FN4.js";import"./_getTag-C4fv2peH.js";import"./_baseIsEqual-Cdnsi4t8.js";import"./_toKey-BvVjBIlz.js";import"./memoize-D2QB0zzX.js";import"./get-Bi1nZ6vb.js";import"./merge-DrdmtLTL.js";import"./_baseSlice-B27Cqkm6.js";import"./upperFirst-CVedXayx.js";import"./_hasUnicode-CPHpt5EV.js";import"./capitalize-DcZ4F_0s.js";import"./_arrayReduce-DDpPg0Qh.js";import"./startCase-D58-CT5H.js";import"./_baseProperty-CIKnF2iY.js";import"./now-CKgsywea.js";import"./debounce-Bzqd6azt.js";import{t as Ut}from"./isEmpty-D1b_MAwx.js";import"./invariant-91cSKJcr.js";import"./client-RNr6mM1Y.js";import{t as ne}from"./Logger-BkkOJyg0.js";import"./hotkeys-CBY41Jr2.js";import{n as Xt,r as qt}from"./utils-DBmmAf_K.js";import"./constants-Cv7-oioA.js";import{a as Vt}from"./config-DXGmIv9f.js";import"./useHotkey-DkiyGPLs.js";import{a as ie}from"./dist-CLazWf1X.js";import{t as V}from"./cn-Dr9kMPPj.js";import"./dist-D-dnh2ed.js";import"./useEventListener-g9rPKvBX.js";import"./events-BGfCi1Xy.js";import{t as U}from"./button-Bxk0BtBn.js";import"./dist-CoL9j4yJ.js";import"./dist-Cs8TISgf.js";import"./once-8ZDiGGtA.js";import"./documentation-B7z6bB-t.js";import"./createReducer-CFr1RdS2.js";import{a as Bt}from"./key-D4QiH_7H.js";import"./preload-helper-DImqtvgl.js";import"./dist-Bz53xjA5.js";import"./dist-CyqTsfyg.js";import"./dist-CjoeBoZ9.js";import"./dist-Dlusp3mb.js";import"./dist-DzUKODTF.js";import"./dist-Dm8m1boP.js";import"./stex-BrOrfhKB.js";import"./Deferred-Mppm0cvJ.js";import"./uuid-4lb_EYpq.js";import{t as Jt}from"./use-toast-D6NNsC80.js";import"./main-CfqcqCNp.js";import"./marked.esm-C_54K2ke.js";import"./connection-D2GvycR9.js";import"./dist-DvDyxv8b.js";import"./useTheme-oPMxEKRc.js";import"./createLucideIcon-QLW8E4z5.js";import{S as $t,T as Gt,c as tt,d as Kt,f as Qt,g as Zt,l as er,m as tr,n as rt,p as rr,u as ot,w as or,x as lr}from"./add-cell-with-ai-CxM_YKzf.js";import"./between-horizontal-start-DWTOsiF_.js";import{n as qe,t as sr}from"./square-DKPXnMmD.js";import{c as ar,o as nr,t as ir}from"./ai-model-dropdown-DSUVFIso.js";import{i as cr,n as lt}from"./state-B37sZn4X.js";import"./type-kF6pOJbH.js";import"./check-C5PVLNkJ.js";import{a as dr,i as mr,n as ur,p as pr,r as hr,s as fr,t as xr}from"./select-DKRTzlUU.js";import"./chevron-right-BDEhimQq.js";import"./ansi_up-D_b0GS7N.js";import{n as vr}from"./plug-DrNpofTj.js";import"./toDate-Daj1hQSF.js";import{t as gr}from"./circle-x-BsVcxKkV.js";import"./dropdown-menu-CJDB1PNI.js";import"./copy-6mpL4BeI.js";import"./download-BB5Iexmn.js";import"./file-text-Lr1kJd4E.js";import"./file-BENStGHx.js";import"./image-DTv0Ic6H.js";import{n as st}from"./spinner-BhnfQOEl.js";import{n as br,t as wr}from"./send-DRRBOpzT.js";import{t as jr}from"./plus-d2HNOuZI.js";import"./refresh-cw-B_tmnHav.js";import{Rt as yr,r as at}from"./input-C1RzjWSK.js";import{t as Nr}from"./settings-6ySBJQ7Y.js";import"./useDeleteCell-CJaipocw.js";import"./form-BGZvwlog.js";import"./trash-2-3UJSaMKF.js";import"./VisuallyHidden-BiHw-PIc.js";import{t as Sr}from"./wrench-B2m2X1sb.js";import"./useNonce-BbWkd3B4.js";import"./badge-DJuT6BaT.js";import{S as B,g as fe,h as J,v as Ee,w as Cr,x as _r}from"./namespace-CnoeT75h.js";import{r as nt,t as ce}from"./tooltip-ULHbIsj9.js";import"./useLifecycle-BfeAlD80.js";import{u as Rr}from"./menu-items-Bo6Dyd_Q.js";import"./fullscreen-DTPr3iBY.js";import"./tslib.es6-dlz5WbC8.js";import{i as Ar}from"./dates-Au76svwW.js";import"./en-US-CjWuOpsV.js";import"./isValid-o3nZVu8e.js";import"./alert-dialog-BO8sf-73.js";import"./dialog-CR68_CUl.js";import{r as Tr}from"./useNumberFormatter-D21brJ0f.js";import"./shim-CWt9rDBn.js";import{n as $}from"./useEvent-BOb1a9d1.js";import"./useDebounce-_ztZiL0I.js";import"./strings-DYBy5ejj.js";import"./errors-_3XAtRr3.js";import"./copy-CkZsxeON.js";import{t as Er}from"./copy-icon-6ICckC-p.js";import{i as it,n as ct,r as dt,t as mt}from"./accordion-A41ffd5P.js";import"./extends-Bwhapo2B.js";import"./objectWithoutPropertiesLoose-CDpgRi8_.js";import"./useAsyncData-D9GA9BWg.js";import{n as Pr}from"./error-banner-BGjnZePp.js";import"./kbd-BQFiWIjd.js";import"./renderShortcut-C9_NT6sD.js";import"./label-BEUjZsdo.js";import"./LazyAnyLanguageCodeMirror-RkzkO2YV.js";import{i as Lr,r as zr,t as Dr}from"./popover-DW0D4l0O.js";import"./es-BVCqnQhJ.js";import"./dom-CT3dAMQW.js";import"./blob-CTPcPiam.js";import"./esm-7XxuulnL.js";import"./add-missing-import-CfRgNApn.js";import"./icons-CLD-J5J3.js";import"./table-CE-j9Qo6.js";import"./links-CkROMZxn.js";import{r as ut,t as Ir}from"./state-jvUYiWCG.js";import"./tabs-8ThyQfYh.js";import"./focus-Bnk25hTp.js";import"./textarea-B-_OthMe.js";import"./switch-B5bMMWJn.js";import{n as kr,r as Ve,t as Mr}from"./chat-components-OoNU4tLf.js";import"./katex-DBBxCH7Z.js";import{t as Be}from"./empty-state-TdWBDq6n.js";var pt=ae(Te()),h=ae(kt(),1);const Fr=({chatState:t,chatId:e,messages:r})=>{if(!e)return ne.warn("No active chat"),t;let a=t.chats.get(e);if(!a)return ne.warn("No active chat"),t;let l=new Map(t.chats),s=Date.now();return l.set(a.id,{...a,messages:r,updatedAt:s}),{...t,chats:l}};var o=ae(Yt(),1);function Or(t,e){return h.useReducer((r,a)=>e[r][a]??r,t)}var Je="ScrollArea",[ht,xa]=Cr(Je),[Wr,F]=ht(Je),ft=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,type:a="hover",dir:l,scrollHideDelay:s=600,...n}=t,[i,c]=h.useState(null),[d,m]=h.useState(null),[u,p]=h.useState(null),[f,v]=h.useState(null),[N,A]=h.useState(null),[x,w]=h.useState(0),[_,y]=h.useState(0),[g,S]=h.useState(!1),[T,E]=h.useState(!1),j=ie(e,P=>c(P)),C=Rr(l);return(0,o.jsx)(Wr,{scope:r,type:a,dir:C,scrollHideDelay:s,scrollArea:i,viewport:d,onViewportChange:m,content:u,onContentChange:p,scrollbarX:f,onScrollbarXChange:v,scrollbarXEnabled:g,onScrollbarXEnabledChange:S,scrollbarY:N,onScrollbarYChange:A,scrollbarYEnabled:T,onScrollbarYEnabledChange:E,onCornerWidthChange:w,onCornerHeightChange:y,children:(0,o.jsx)(fe.div,{dir:C,...n,ref:j,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":_+"px",...t.style}})})});ft.displayName=Je;var xt="ScrollAreaViewport",vt=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,children:a,nonce:l,...s}=t,n=F(xt,r),i=h.useRef(null),c=ie(e,i,n.onViewportChange);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),(0,o.jsx)(fe.div,{"data-radix-scroll-area-viewport":"",...s,ref:c,style:{overflowX:n.scrollbarXEnabled?"scroll":"hidden",overflowY:n.scrollbarYEnabled?"scroll":"hidden",...t.style},children:(0,o.jsx)("div",{ref:n.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});vt.displayName=xt;var Y="ScrollAreaScrollbar",$e=h.forwardRef((t,e)=>{let{forceMount:r,...a}=t,l=F(Y,t.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:n}=l,i=t.orientation==="horizontal";return h.useEffect(()=>(i?s(!0):n(!0),()=>{i?s(!1):n(!1)}),[i,s,n]),l.type==="hover"?(0,o.jsx)(Hr,{...a,ref:e,forceMount:r}):l.type==="scroll"?(0,o.jsx)(Yr,{...a,ref:e,forceMount:r}):l.type==="auto"?(0,o.jsx)(gt,{...a,ref:e,forceMount:r}):l.type==="always"?(0,o.jsx)(Ge,{...a,ref:e}):null});$e.displayName=Y;var Hr=h.forwardRef((t,e)=>{let{forceMount:r,...a}=t,l=F(Y,t.__scopeScrollArea),[s,n]=h.useState(!1);return h.useEffect(()=>{let i=l.scrollArea,c=0;if(i){let d=()=>{window.clearTimeout(c),n(!0)},m=()=>{c=window.setTimeout(()=>n(!1),l.scrollHideDelay)};return i.addEventListener("pointerenter",d),i.addEventListener("pointerleave",m),()=>{window.clearTimeout(c),i.removeEventListener("pointerenter",d),i.removeEventListener("pointerleave",m)}}},[l.scrollArea,l.scrollHideDelay]),(0,o.jsx)(Ee,{present:r||s,children:(0,o.jsx)(gt,{"data-state":s?"visible":"hidden",...a,ref:e})})}),Yr=h.forwardRef((t,e)=>{let{forceMount:r,...a}=t,l=F(Y,t.__scopeScrollArea),s=t.orientation==="horizontal",n=De(()=>c("SCROLL_END"),100),[i,c]=Or("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return h.useEffect(()=>{if(i==="idle"){let d=window.setTimeout(()=>c("HIDE"),l.scrollHideDelay);return()=>window.clearTimeout(d)}},[i,l.scrollHideDelay,c]),h.useEffect(()=>{let d=l.viewport,m=s?"scrollLeft":"scrollTop";if(d){let u=d[m],p=()=>{let f=d[m];u!==f&&(c("SCROLL"),n()),u=f};return d.addEventListener("scroll",p),()=>d.removeEventListener("scroll",p)}},[l.viewport,s,c,n]),(0,o.jsx)(Ee,{present:r||i!=="hidden",children:(0,o.jsx)(Ge,{"data-state":i==="hidden"?"hidden":"visible",...a,ref:e,onPointerEnter:B(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:B(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),gt=h.forwardRef((t,e)=>{let r=F(Y,t.__scopeScrollArea),{forceMount:a,...l}=t,[s,n]=h.useState(!1),i=t.orientation==="horizontal",c=De(()=>{if(r.viewport){let d=r.viewport.offsetWidth<r.viewport.scrollWidth,m=r.viewport.offsetHeight<r.viewport.scrollHeight;n(i?d:m)}},10);return de(r.viewport,c),de(r.content,c),(0,o.jsx)(Ee,{present:a||s,children:(0,o.jsx)(Ge,{"data-state":s?"visible":"hidden",...l,ref:e})})}),Ge=h.forwardRef((t,e)=>{let{orientation:r="vertical",...a}=t,l=F(Y,t.__scopeScrollArea),s=h.useRef(null),n=h.useRef(0),[i,c]=h.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=Nt(i.viewport,i.content),m={...a,sizes:i,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:p=>s.current=p,onThumbPointerUp:()=>n.current=0,onThumbPointerDown:p=>n.current=p};function u(p,f){return Jr(p,n.current,i,f)}return r==="horizontal"?(0,o.jsx)(Ur,{...m,ref:e,onThumbPositionChange:()=>{if(l.viewport&&s.current){let p=l.viewport.scrollLeft,f=St(p,i,l.dir);s.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:p=>{l.viewport&&(l.viewport.scrollLeft=p)},onDragScroll:p=>{l.viewport&&(l.viewport.scrollLeft=u(p,l.dir))}}):r==="vertical"?(0,o.jsx)(Xr,{...m,ref:e,onThumbPositionChange:()=>{if(l.viewport&&s.current){let p=l.viewport.scrollTop,f=St(p,i);s.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:p=>{l.viewport&&(l.viewport.scrollTop=p)},onDragScroll:p=>{l.viewport&&(l.viewport.scrollTop=u(p))}}):null}),Ur=h.forwardRef((t,e)=>{let{sizes:r,onSizesChange:a,...l}=t,s=F(Y,t.__scopeScrollArea),[n,i]=h.useState(),c=h.useRef(null),d=ie(e,c,s.onScrollbarXChange);return h.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),(0,o.jsx)(wt,{"data-orientation":"horizontal",...l,ref:d,sizes:r,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":ze(r)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.x),onDragScroll:m=>t.onDragScroll(m.x),onWheelScroll:(m,u)=>{if(s.viewport){let p=s.viewport.scrollLeft+m.deltaX;t.onWheelScroll(p),_t(p,u)&&m.preventDefault()}},onResize:()=>{c.current&&s.viewport&&n&&a({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Le(n.paddingLeft),paddingEnd:Le(n.paddingRight)}})}})}),Xr=h.forwardRef((t,e)=>{let{sizes:r,onSizesChange:a,...l}=t,s=F(Y,t.__scopeScrollArea),[n,i]=h.useState(),c=h.useRef(null),d=ie(e,c,s.onScrollbarYChange);return h.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),(0,o.jsx)(wt,{"data-orientation":"vertical",...l,ref:d,sizes:r,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":ze(r)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.y),onDragScroll:m=>t.onDragScroll(m.y),onWheelScroll:(m,u)=>{if(s.viewport){let p=s.viewport.scrollTop+m.deltaY;t.onWheelScroll(p),_t(p,u)&&m.preventDefault()}},onResize:()=>{c.current&&s.viewport&&n&&a({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Le(n.paddingTop),paddingEnd:Le(n.paddingBottom)}})}})}),[qr,bt]=ht(Y),wt=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,sizes:a,hasThumb:l,onThumbChange:s,onThumbPointerUp:n,onThumbPointerDown:i,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:m,onResize:u,...p}=t,f=F(Y,r),[v,N]=h.useState(null),A=ie(e,j=>N(j)),x=h.useRef(null),w=h.useRef(""),_=f.viewport,y=a.content-a.viewport,g=J(m),S=J(c),T=De(u,10);function E(j){if(x.current){let C=j.clientX-x.current.left,P=j.clientY-x.current.top;d({x:C,y:P})}}return h.useEffect(()=>{let j=C=>{let P=C.target;v!=null&&v.contains(P)&&g(C,y)};return document.addEventListener("wheel",j,{passive:!1}),()=>document.removeEventListener("wheel",j,{passive:!1})},[_,v,y,g]),h.useEffect(S,[a,S]),de(v,T),de(f.content,T),(0,o.jsx)(qr,{scope:r,scrollbar:v,hasThumb:l,onThumbChange:J(s),onThumbPointerUp:J(n),onThumbPositionChange:S,onThumbPointerDown:J(i),children:(0,o.jsx)(fe.div,{...p,ref:A,style:{position:"absolute",...p.style},onPointerDown:B(t.onPointerDown,j=>{j.button===0&&(j.target.setPointerCapture(j.pointerId),x.current=v.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),E(j))}),onPointerMove:B(t.onPointerMove,E),onPointerUp:B(t.onPointerUp,j=>{let C=j.target;C.hasPointerCapture(j.pointerId)&&C.releasePointerCapture(j.pointerId),document.body.style.webkitUserSelect=w.current,f.viewport&&(f.viewport.style.scrollBehavior=""),x.current=null})})})}),Pe="ScrollAreaThumb",jt=h.forwardRef((t,e)=>{let{forceMount:r,...a}=t,l=bt(Pe,t.__scopeScrollArea);return(0,o.jsx)(Ee,{present:r||l.hasThumb,children:(0,o.jsx)(Vr,{ref:e,...a})})}),Vr=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,style:a,...l}=t,s=F(Pe,r),n=bt(Pe,r),{onThumbPositionChange:i}=n,c=ie(e,u=>n.onThumbChange(u)),d=h.useRef(void 0),m=De(()=>{d.current&&(d.current=(d.current(),void 0))},100);return h.useEffect(()=>{let u=s.viewport;if(u){let p=()=>{m(),d.current||(d.current=$r(u,i),i())};return i(),u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[s.viewport,m,i]),(0,o.jsx)(fe.div,{"data-state":n.hasThumb?"visible":"hidden",...l,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:B(t.onPointerDownCapture,u=>{let p=u.target.getBoundingClientRect(),f=u.clientX-p.left,v=u.clientY-p.top;n.onThumbPointerDown({x:f,y:v})}),onPointerUp:B(t.onPointerUp,n.onThumbPointerUp)})});jt.displayName=Pe;var Ke="ScrollAreaCorner",yt=h.forwardRef((t,e)=>{let r=F(Ke,t.__scopeScrollArea),a=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&a?(0,o.jsx)(Br,{...t,ref:e}):null});yt.displayName=Ke;var Br=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,...a}=t,l=F(Ke,r),[s,n]=h.useState(0),[i,c]=h.useState(0),d=!!(s&&i);return de(l.scrollbarX,()=>{var u;let m=((u=l.scrollbarX)==null?void 0:u.offsetHeight)||0;l.onCornerHeightChange(m),c(m)}),de(l.scrollbarY,()=>{var u;let m=((u=l.scrollbarY)==null?void 0:u.offsetWidth)||0;l.onCornerWidthChange(m),n(m)}),d?(0,o.jsx)(fe.div,{...a,ref:e,style:{width:s,height:i,position:"absolute",right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Le(t){return t?parseInt(t,10):0}function Nt(t,e){let r=t/e;return isNaN(r)?0:r}function ze(t){let e=Nt(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=(t.scrollbar.size-r)*e;return Math.max(a,18)}function Jr(t,e,r,a="ltr"){let l=ze(r),s=l/2,n=e||s,i=l-n,c=r.scrollbar.paddingStart+n,d=r.scrollbar.size-r.scrollbar.paddingEnd-i,m=r.content-r.viewport,u=a==="ltr"?[0,m]:[m*-1,0];return Ct([c,d],u)(t)}function St(t,e,r="ltr"){let a=ze(e),l=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=e.scrollbar.size-l,n=e.content-e.viewport,i=s-a,c=r==="ltr"?[0,n]:[n*-1,0],d=pr(t,c);return Ct([0,n],[0,i])(d)}function Ct(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];let a=(e[1]-e[0])/(t[1]-t[0]);return e[0]+a*(r-t[0])}}function _t(t,e){return t>0&&t<e}var $r=(t,e=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},a=0;return(function l(){let s={left:t.scrollLeft,top:t.scrollTop},n=r.left!==s.left,i=r.top!==s.top;(n||i)&&e(),r=s,a=window.requestAnimationFrame(l)})(),()=>window.cancelAnimationFrame(a)};function De(t,e){let r=J(t),a=h.useRef(0);return h.useEffect(()=>()=>window.clearTimeout(a.current),[]),h.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(r,e)},[r,e])}function de(t,e){let r=J(e);_r(()=>{let a=0;if(t){let l=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(r)});return l.observe(t),()=>{window.cancelAnimationFrame(a),l.unobserve(t)}}},[t,r])}var Rt=ft,Gr=vt,Kr=yt,At=h.forwardRef((t,e)=>{let r=(0,pt.c)(15),a,l,s;r[0]===t?(a=r[1],l=r[2],s=r[3]):({className:l,children:a,...s}=t,r[0]=t,r[1]=a,r[2]=l,r[3]=s);let n;r[4]===l?n=r[5]:(n=V("relative overflow-hidden",l),r[4]=l,r[5]=n);let i;r[6]===a?i=r[7]:(i=(0,o.jsx)(Gr,{className:"h-full w-full rounded-[inherit]",children:a}),r[6]=a,r[7]=i);let c,d;r[8]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(Tt,{}),d=(0,o.jsx)(Kr,{}),r[8]=c,r[9]=d):(c=r[8],d=r[9]);let m;return r[10]!==s||r[11]!==e||r[12]!==n||r[13]!==i?(m=(0,o.jsxs)(Rt,{ref:e,className:n,...s,children:[i,c,d]}),r[10]=s,r[11]=e,r[12]=n,r[13]=i,r[14]=m):m=r[14],m});At.displayName=Rt.displayName;var Tt=h.forwardRef((t,e)=>{let r=(0,pt.c)(14),a,l,s;r[0]===t?(a=r[1],l=r[2],s=r[3]):({className:a,orientation:s,...l}=t,r[0]=t,r[1]=a,r[2]=l,r[3]=s);let n=s===void 0?"vertical":s,i=n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-px",c=n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-px",d;r[4]!==a||r[5]!==i||r[6]!==c?(d=V("flex touch-none select-none transition-colors",i,c,a),r[4]=a,r[5]=i,r[6]=c,r[7]=d):d=r[7];let m;r[8]===Symbol.for("react.memo_cache_sentinel")?(m=(0,o.jsx)(jt,{className:"relative flex-1 rounded-full bg-border"}),r[8]=m):m=r[8];let u;return r[9]!==n||r[10]!==l||r[11]!==e||r[12]!==d?(u=(0,o.jsx)($e,{ref:e,orientation:n,className:d,...l,children:m}),r[9]=n,r[10]=l,r[11]=e,r[12]=d,r[13]=u):u=r[13],u});Tt.displayName=$e.displayName;var Qr=[{label:"Today",days:0},{label:"Yesterday",days:1},{label:"2d ago",days:2},{label:"3d ago",days:3},{label:"This week",days:7},{label:"This month",days:30}];const Zr=t=>{let e=Date.now(),r=Qr.map(s=>({...s,chats:[]})),a={label:"Older",days:1/0,chats:[]},l=s=>{switch(s){case 0:return r[0];case 1:return r[1];case 2:return r[2];case 3:return r[3];default:return s>=4&&s<=7?r[4]:s>=8&&s<=30?r[5]:a}};for(let s of t){let n=Math.floor((e-s.updatedAt)/864e5);l(n).chats.push(s)}return[...r,a].filter(s=>s.chats.length>0)},eo=({activeChatId:t,setActiveChat:e})=>{let r=Ue(ut),{locale:a}=Tr(),[l,s]=(0,h.useState)(""),n=(0,h.useMemo)(()=>[...r.chats.values()].sort((d,m)=>m.updatedAt-d.updatedAt),[r.chats]),i=(0,h.useMemo)(()=>l.trim()?n.filter(d=>d.title.toLowerCase().includes(l.toLowerCase())):n,[n,l]),c=(0,h.useMemo)(()=>Zr(i),[i]);return(0,o.jsxs)(Dr,{children:[(0,o.jsx)(ce,{content:"Previous chats",children:(0,o.jsx)(Lr,{asChild:!0,children:(0,o.jsx)(U,{variant:"text",size:"icon",children:(0,o.jsx)(Mt,{className:"h-4 w-4"})})})}),(0,o.jsxs)(zr,{className:"w-[480px] p-0",align:"start",side:"right",children:[(0,o.jsx)("div",{className:"pt-3 px-3 w-full",children:(0,o.jsx)(at,{placeholder:"Search chat history...",value:l,onChange:d=>s(d.target.value),className:"text-xs"})}),(0,o.jsx)(At,{className:"h-[450px] p-2",children:(0,o.jsxs)("div",{className:"space-y-3",children:[n.length===0&&(0,o.jsx)(Be,{title:"No chats yet",description:"Start a new chat to get started",icon:(0,o.jsx)(qe,{})}),i.length===0&&l&&n.length>0&&(0,o.jsx)(Be,{title:"No chats found",description:`No chats match "${l}"`,icon:(0,o.jsx)(yr,{})}),c.map((d,m)=>(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("div",{className:"text-xs px-1 text-muted-foreground/60",children:d.label}),(0,o.jsx)("div",{children:d.chats.map(u=>(0,o.jsxs)("button",{className:V("w-full p-1 rounded-md cursor-pointer text-left flex items-center justify-between",u.id===t&&"bg-accent",u.id!==t&&"hover:bg-muted/20"),onClick:()=>{e(u.id)},type:"button",children:[(0,o.jsx)("div",{className:"flex-1 min-w-0",children:(0,o.jsx)("div",{className:"text-sm truncate",children:u.title})}),(0,o.jsx)("div",{className:"text-xs text-muted-foreground/60 ml-2 flex-shrink-0",children:Ar(u.updatedAt,a)})]},u.id))}),m!==c.length-1&&(0,o.jsx)("hr",{})]},d.label))]})})]})]})};var to=ae(Te());const ro=t=>{let e=(0,to.c)(13),{reasoning:r,index:a,isStreaming:l}=t,s=a===void 0?0:a,n=l===void 0?!1:l,i=n?"reasoning":void 0,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(qe,{className:"h-3 w-3"}),e[0]=c):c=e[0];let d=n?"Thinking":"View reasoning",m;e[1]!==r.length||e[2]!==d?(m=(0,o.jsx)(it,{className:"text-xs text-muted-foreground hover:bg-muted/50 px-2 py-1 h-auto rounded-sm [&[data-state=open]>svg]:rotate-180",children:(0,o.jsxs)("span",{className:"flex items-center gap-2",children:[c,d," (",r.length," ","chars)"]})}),e[1]=r.length,e[2]=d,e[3]=m):m=e[3];let u;e[4]===r?u=e[5]:(u=(0,o.jsx)(ct,{className:"pb-2 px-2",children:(0,o.jsx)("div",{className:"bg-muted/30 border border-muted/50 rounded-md p-3 italic text-muted-foreground/90 relative",children:(0,o.jsx)("div",{className:"pr-6",children:(0,o.jsx)(Ve,{content:r})})})}),e[4]=r,e[5]=u);let p;e[6]!==m||e[7]!==u?(p=(0,o.jsxs)(dt,{value:"reasoning",className:"border-0",children:[m,u]}),e[6]=m,e[7]=u,e[8]=p):p=e[8];let f;return e[9]!==s||e[10]!==i||e[11]!==p?(f=(0,o.jsx)(mt,{type:"single",collapsible:!0,className:"w-full mb-2",value:i,children:p},s),e[9]=s,e[10]=i,e[11]=p,e[12]=f):f=e[12],f};var Ie=ae(Te()),oo=Ht({status:et().default("success"),auth_required:Wt().default(!1),action_url:Xe(),next_steps:Xe(),meta:Xe(),message:et().nullish()}).passthrough(),lo=t=>{let e=(0,Ie.c)(12),{data:r}=t,a;if(e[0]!==r){let{status:l,auth_required:s,action_url:n,meta:i,next_steps:c,message:d,...m}=r,u;e[2]===Symbol.for("react.memo_cache_sentinel")?(u=(0,o.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground",children:"Tool Result"}),e[2]=u):u=e[2];let p;e[3]===l?p=e[4]:(p=(0,o.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--grass-2)] text-[var(--grass-11)] rounded-full font-medium capitalize",children:l}),e[3]=l,e[4]=p);let f;e[5]===s?f=e[6]:(f=s&&(0,o.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--amber-2)] text-[var(--amber-11)] rounded-full",children:"Auth Required"}),e[5]=s,e[6]=f);let v;e[7]!==p||e[8]!==f?(v=(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[u,(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[p,f]})]}),e[7]=p,e[8]=f,e[9]=v):v=e[9];let N;e[10]===d?N=e[11]:(N=d&&(0,o.jsxs)("div",{className:"flex items-start gap-2",children:[(0,o.jsx)(Ft,{className:"h-3 w-3 text-[var(--blue-11)] mt-0.5 flex-shrink-0"}),(0,o.jsx)("div",{className:"text-xs text-foreground",children:d})]}),e[10]=d,e[11]=N),a=(0,o.jsxs)("div",{className:"flex flex-col gap-1.5",children:[v,N,m&&(0,o.jsx)("div",{className:"space-y-3",children:Object.entries(m).map(io)})]}),e[0]=r,e[1]=a}else a=e[1];return a},so=t=>{let e=(0,Ie.c)(8),{result:r}=t,a;e[0]===r?a=e[1]:(a=oo.safeParse(r),e[0]=r,e[1]=a);let l=a;if(l.success){let i;return e[2]===l.data?i=e[3]:(i=(0,o.jsx)(lo,{data:l.data}),e[2]=l.data,e[3]=i),i}let s;e[4]===r?s=e[5]:(s=typeof r=="string"?r:JSON.stringify(r,null,2),e[4]=r,e[5]=s);let n;return e[6]===s?n=e[7]:(n=(0,o.jsx)("div",{className:"text-xs font-medium text-muted-foreground mb-1 max-h-64 overflow-y-auto scrollbar-thin",children:s}),e[6]=s,e[7]=n),n},ao=t=>{let e=(0,Ie.c)(6),{input:r}=t;if(!(r&&r!==null))return null;let a=typeof r=="object"&&Object.keys(r).length>0,l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=(0,o.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground",children:"Tool Request"}),e[0]=l):l=e[0];let s;e[1]!==r||e[2]!==a?(s=a?JSON.stringify(r,null,2):String(r),e[1]=r,e[2]=a,e[3]=s):s=e[3];let n;return e[4]===s?n=e[5]:(n=(0,o.jsxs)("div",{className:"space-y-2",children:[l,(0,o.jsx)("pre",{className:"bg-[var(--slate-2)] p-2 text-muted-foreground border border-[var(--slate-4)] rounded text-xs overflow-auto scrollbar-thin max-h-64",children:s})]}),e[4]=s,e[5]=n),n};const Et=t=>{let e=(0,Ie.c)(38),{toolName:r,result:a,error:l,index:s,state:n,className:i,input:c}=t,d=s===void 0?0:s,m=n==="output-available"&&(a||l),u=l?"error":m?"success":"loading",p;e[0]===u?p=e[1]:(p=()=>{switch(u){case"loading":return(0,o.jsx)(st,{className:"h-3 w-3 animate-spin"});case"error":return(0,o.jsx)(gr,{className:"h-3 w-3 text-[var(--red-11)]"});case"success":return(0,o.jsx)(vr,{className:"h-3 w-3 text-[var(--grass-11)]"});default:return(0,o.jsx)(Sr,{className:"h-3 w-3"})}},e[0]=u,e[1]=p);let f=p,v;e[2]!==l||e[3]!==m||e[4]!==u?(v=()=>u==="loading"?"Running":l?"Failed":m?"Done":"Tool call",e[2]=l,e[3]=m,e[4]=u,e[5]=v):v=e[5];let N=v,A=`tool-${d}`,x;e[6]===i?x=e[7]:(x=V("w-full",i),e[6]=i,e[7]=x);let w=u==="error"&&"text-[var(--red-11)]/80",_=u==="success"&&"text-[var(--grass-11)]/80",y;e[8]!==w||e[9]!==_?(y=V("h-6 text-xs border-border shadow-none! ring-0! bg-muted/60 hover:bg-muted py-0 px-2 gap-1 rounded-sm [&[data-state=open]>svg]:rotate-180 hover:no-underline",w,_),e[8]=w,e[9]=_,e[10]=y):y=e[10];let g;e[11]===f?g=e[12]:(g=f(),e[11]=f,e[12]=g);let S=N(),T;e[13]===r?T=e[14]:(T=no(r),e[13]=r,e[14]=T);let E;e[15]===T?E=e[16]:(E=(0,o.jsx)("code",{className:"font-mono text-xs",children:T}),e[15]=T,e[16]=E);let j;e[17]!==S||e[18]!==E||e[19]!==g?(j=(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[g,S,":",E]}),e[17]=S,e[18]=E,e[19]=g,e[20]=j):j=e[20];let C;e[21]!==j||e[22]!==y?(C=(0,o.jsx)(it,{className:y,children:j}),e[21]=j,e[22]=y,e[23]=C):C=e[23];let P;e[24]!==l||e[25]!==m||e[26]!==c||e[27]!==a?(P=m&&(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsx)(ao,{input:c}),a!=null&&(0,o.jsx)(so,{result:a}),l&&(0,o.jsxs)("div",{className:"bg-[var(--red-2)] border border-[var(--red-6)] rounded-lg p-3",children:[(0,o.jsxs)("div",{className:"text-xs font-semibold text-[var(--red-11)] mb-2 flex items-center gap-2",children:[(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-[var(--red-9)] rounded-full"}),"Error"]}),(0,o.jsx)("div",{className:"text-sm text-[var(--red-11)] leading-relaxed",children:l})]})]}),e[24]=l,e[25]=m,e[26]=c,e[27]=a,e[28]=P):P=e[28];let k;e[29]===P?k=e[30]:(k=(0,o.jsx)(ct,{className:"py-2 px-2",children:P}),e[29]=P,e[30]=k);let I;e[31]!==C||e[32]!==k?(I=(0,o.jsxs)(dt,{value:"tool-call",className:"border-0",children:[C,k]}),e[31]=C,e[32]=k,e[33]=I):I=e[33];let z;return e[34]!==I||e[35]!==A||e[36]!==x?(z=(0,o.jsx)(mt,{type:"single",collapsible:!0,className:x,children:I},A),e[34]=I,e[35]=A,e[36]=x,e[37]=z):z=e[37],z};function no(t){return t.replace("tool-","")}function io(t){let[e,r]=t;return Ut(r)?null:(0,o.jsxs)("div",{className:"space-y-1.5",children:[(0,o.jsxs)("div",{className:"text-xs font-medium text-muted-foreground capitalize flex items-center gap-2",children:[(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-[var(--blue-9)] rounded-full"}),e]}),(0,o.jsx)("pre",{className:"bg-[var(--slate-2)] p-2 text-muted-foreground border border-[var(--slate-4)] rounded text-xs overflow-auto scrollbar-thin max-h-64",children:JSON.stringify(r,null,2)})]},e)}var me=ae(Te()),co="manual",mo=new Set(["openai","google","anthropic"]),uo=["image/*","text/*"],po=1024*1024*50,ho=t=>{let e=(0,me.c)(18),{onNewChat:r,activeChatId:a,setActiveChat:l}=t,{handleClick:s}=lt(),n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsx)(jr,{className:"h-4 w-4"}),e[0]=n):n=e[0];let i;e[1]===r?i=e[2]:(i=(0,o.jsx)(ce,{content:"New chat",children:(0,o.jsx)(U,{variant:"text",size:"icon",onClick:r,children:n})}),e[1]=r,e[2]=i);let c;e[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(cr,{}),e[3]=c):c=e[3];let d;e[4]===s?d=e[5]:(d=()=>s("ai"),e[4]=s,e[5]=d);let m;e[6]===Symbol.for("react.memo_cache_sentinel")?(m=(0,o.jsx)(Nr,{className:"h-4 w-4"}),e[6]=m):m=e[6];let u;e[7]===d?u=e[8]:(u=(0,o.jsx)(ce,{content:"AI Settings",children:(0,o.jsx)(U,{variant:"text",size:"xs",className:"hover:bg-foreground/10 py-2",onClick:d,children:m})}),e[7]=d,e[8]=u);let p;e[9]!==a||e[10]!==l?(p=(0,o.jsx)(eo,{activeChatId:a,setActiveChat:l}),e[9]=a,e[10]=l,e[11]=p):p=e[11];let f;e[12]!==u||e[13]!==p?(f=(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[c,u,p]}),e[12]=u,e[13]=p,e[14]=f):f=e[14];let v;return e[15]!==i||e[16]!==f?(v=(0,o.jsxs)("div",{className:"flex border-b px-2 py-1 justify-between shrink-0 items-center",children:[i,f]}),e[15]=i,e[16]=f,e[17]=v):v=e[17],v};function fo(t){return t.type.startsWith("tool-")}var Pt=(0,h.memo)(t=>{let e=(0,me.c)(15),{message:r,index:a,onEdit:l,isStreamingReasoning:s,isLast:n}=t,i;e[0]!==a||e[1]!==l?(i=N=>{var w,_,y;let A=(_=(w=N.parts)==null?void 0:w.filter(bo))==null?void 0:_.map(wo).join(`
`),x=(y=N.parts)==null?void 0:y.filter(jo);return(0,o.jsxs)("div",{className:"w-[95%] bg-background border p-1 rounded-sm",children:[x==null?void 0:x.map(yo),(0,o.jsx)(rt,{value:A,placeholder:"Type your message...",onChange:No,onSubmit:(g,S)=>{S.trim()&&l(a,S)},onClose:So},N.id)]})},e[0]=a,e[1]=l,e[2]=i):i=e[2];let c=i,d;e[3]!==n||e[4]!==s?(d=N=>{let A=N.parts.filter(Co).map(_o).join(`
`);return(0,o.jsxs)("div",{className:"w-[95%] break-words",children:[(0,o.jsx)("div",{className:"absolute right-1 top-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,o.jsx)(Er,{className:"h-3 w-3",value:A||""})}),N.parts.map((x,w)=>{if(fo(x))return(0,o.jsx)(Et,{index:w,toolName:x.type,result:x.output,className:"my-2",state:x.state,input:x.input},w);switch(x.type){case"text":return(0,o.jsx)(Ve,{content:x.text},w);case"reasoning":return(0,o.jsx)(ro,{reasoning:x.text,index:w,isStreaming:n&&s&&w===(N.parts.length||0)-1},w);case"dynamic-tool":return(0,o.jsx)(Et,{index:w,toolName:x.type,result:x.output,state:x.state,input:x.input,className:"my-2"},w);case"data-reasoning-signature":return null;default:if(x.type.startsWith("data-"))return ne.log("Found data part",x),null;ne.error("Unhandled part type:",x.type);try{return(0,o.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,o.jsx)(Ve,{content:JSON.stringify(x,null,2)})},w)}catch(_){let y=_;return ne.error("Error rendering part:",x.type,y),null}}})]})},e[3]=n,e[4]=s,e[5]=d):d=e[5];let m=d,u=r.role==="user"?"justify-end":"justify-start",p;e[6]===u?p=e[7]:(p=V("flex group relative",u),e[6]=u,e[7]=p);let f;e[8]!==r||e[9]!==m||e[10]!==c?(f=r.role==="user"?c(r):m(r),e[8]=r,e[9]=m,e[10]=c,e[11]=f):f=e[11];let v;return e[12]!==p||e[13]!==f?(v=(0,o.jsx)("div",{className:p,children:f}),e[12]=p,e[13]=f,e[14]=v):v=e[14],v});Pt.displayName="ChatMessage";var Lt=(0,h.memo)(t=>{var D;let e=(0,me.c)(37),{isEmpty:r,onSendClick:a,isLoading:l,onStop:s,fileInputRef:n,onAddFiles:i,onAddContext:c}=t,d=Ue(Xt),m=(d==null?void 0:d.mode)||co,u=((D=d==null?void 0:d.models)==null?void 0:D.chat_model)||"openai/gpt-4o",p=nr.parse(u).providerId,{saveModeChange:f}=ar(),v;e[0]===Symbol.for("react.memo_cache_sentinel")?(v=[{value:"ask",label:"Ask",subtitle:"Use AI with access to read-only tools like documentation search"},{value:"manual",label:"Manual",subtitle:"Pure chat, no tool usage"}],e[0]=v):v=e[0];let N=v,A=mo.has(p),x;e[1]===m?x=e[2]:(x=(0,o.jsx)(fr,{className:"h-6 text-xs border-border shadow-none! ring-0! bg-muted hover:bg-muted/30 py-0 px-2 gap-1 capitalize",children:m}),e[1]=m,e[2]=x);let w;e[3]===Symbol.for("react.memo_cache_sentinel")?(w=(0,o.jsx)(dr,{children:"AI Mode"}),e[3]=w):w=e[3];let _;e[4]===N?_=e[5]:(_=(0,o.jsx)(ur,{children:(0,o.jsxs)(hr,{children:[w,N.map(Ro)]})}),e[4]=N,e[5]=_);let y;e[6]!==m||e[7]!==f||e[8]!==x||e[9]!==_?(y=(0,o.jsx)(Ot,{feature:"chat_modes",children:(0,o.jsxs)(xr,{value:m,onValueChange:f,children:[x,_]})}),e[6]=m,e[7]=f,e[8]=x,e[9]=_,e[10]=y):y=e[10];let g;e[11]===Symbol.for("react.memo_cache_sentinel")?(g=(0,o.jsx)(ir,{placeholder:"Model",triggerClassName:"h-6 text-xs shadow-none! ring-0! bg-muted hover:bg-muted/30 rounded-sm",iconSize:"small",showAddCustomModelDocs:!0,forRole:"chat"}),e[11]=g):g=e[11];let S;e[12]===y?S=e[13]:(S=(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[y,g]}),e[12]=y,e[13]=S);let T;e[14]===Symbol.for("react.memo_cache_sentinel")?(T=(0,o.jsx)(Gt,{className:"h-3.5 w-3.5"}),e[14]=T):T=e[14];let E;e[15]===c?E=e[16]:(E=(0,o.jsx)(ce,{content:"Add context",children:(0,o.jsx)(U,{variant:"text",size:"icon",onClick:c,children:T})}),e[15]=c,e[16]=E);let j;e[17]!==n||e[18]!==A||e[19]!==i?(j=A&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ce,{content:"Attach a file",children:(0,o.jsx)(U,{variant:"text",size:"icon",className:"cursor-pointer",onClick:()=>{var H;return(H=n.current)==null?void 0:H.click()},title:"Attach a file",children:(0,o.jsx)(br,{className:"h-3.5 w-3.5"})})}),(0,o.jsx)(at,{ref:n,type:"file",multiple:!0,hidden:!0,onChange:H=>{H.target.files&&i([...H.target.files])},accept:uo.join(",")})]}),e[17]=n,e[18]=A,e[19]=i,e[20]=j):j=e[20];let C=l?"Stop":"Submit",P=l?s:a,k=l?!1:r,I;e[21]===l?I=e[22]:(I=l?(0,o.jsx)(sr,{className:"h-3 w-3 fill-current"}):(0,o.jsx)(wr,{className:"h-3 w-3"}),e[21]=l,e[22]=I);let z;e[23]!==P||e[24]!==k||e[25]!==I?(z=(0,o.jsx)(U,{variant:"text",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted/30 cursor-pointer",onClick:P,disabled:k,children:I}),e[23]=P,e[24]=k,e[25]=I,e[26]=z):z=e[26];let O;e[27]!==C||e[28]!==z?(O=(0,o.jsx)(ce,{content:C,children:z}),e[27]=C,e[28]=z,e[29]=O):O=e[29];let W;e[30]!==j||e[31]!==O||e[32]!==E?(W=(0,o.jsxs)("div",{className:"flex flex-row",children:[E,j,O]}),e[30]=j,e[31]=O,e[32]=E,e[33]=W):W=e[33];let X;return e[34]!==W||e[35]!==S?(X=(0,o.jsx)(nt,{children:(0,o.jsxs)("div",{className:"px-3 py-2 border-t border-border/20 flex flex-row items-center justify-between",children:[S,W]})}),e[34]=W,e[35]=S,e[36]=X):X=e[36],X});Lt.displayName="ChatInputFooter";var Qe=(0,h.memo)(t=>{let e=(0,me.c)(29),{placeholder:r,input:a,inputClassName:l,setInput:s,onSubmit:n,inputRef:i,isLoading:c,onStop:d,fileInputRef:m,onAddFiles:u,onClose:p}=t,f;e[0]!==a||e[1]!==n?(f=()=>{a.trim()&&n(void 0,a)},e[0]=a,e[1]=n,e[2]=f):f=e[2];let v=$(f),N;e[3]===l?N=e[4]:(N=V("px-2 py-3 flex-1",l),e[3]=l,e[4]=N);let A=r||"Type your message...",x;e[5]!==a||e[6]!==i||e[7]!==u||e[8]!==p||e[9]!==n||e[10]!==s||e[11]!==A?(x=(0,o.jsx)(rt,{inputRef:i,value:a,onChange:s,onSubmit:n,onClose:p,onAddFiles:u,placeholder:A}),e[5]=a,e[6]=i,e[7]=u,e[8]=p,e[9]=n,e[10]=s,e[11]=A,e[12]=x):x=e[12];let w;e[13]!==N||e[14]!==x?(w=(0,o.jsx)("div",{className:N,children:x}),e[13]=N,e[14]=x,e[15]=w):w=e[15];let _=!a.trim(),y;e[16]===i?y=e[17]:(y=()=>Zt(i),e[16]=i,e[17]=y);let g;e[18]!==m||e[19]!==v||e[20]!==c||e[21]!==u||e[22]!==d||e[23]!==_||e[24]!==y?(g=(0,o.jsx)(Lt,{isEmpty:_,onAddContext:y,onSendClick:v,isLoading:c,onStop:d,fileInputRef:m,onAddFiles:u}),e[18]=m,e[19]=v,e[20]=c,e[21]=u,e[22]=d,e[23]=_,e[24]=y,e[25]=g):g=e[25];let S;return e[26]!==w||e[27]!==g?(S=(0,o.jsxs)("div",{className:"relative shrink-0 min-h-[80px] flex flex-col border-t",children:[w,g]}),e[26]=w,e[27]=g,e[28]=S):S=e[28],S});Qe.displayName="ChatInput";var xo=()=>{let t=(0,me.c)(6),e=Ue(qt),{handleClick:r}=lt();if(!e){let l;t[0]===r?l=t[1]:(l=(0,o.jsx)(U,{variant:"outline",size:"sm",onClick:()=>r("ai"),children:"Edit AI settings"}),t[0]=r,t[1]=l);let s;t[2]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.jsx)(qe,{}),t[2]=s):s=t[2];let n;return t[3]===l?n=t[4]:(n=(0,o.jsx)(Be,{title:"Chat with AI",description:"AI is currently disabled. Add your API key to enable.",action:l,icon:s}),t[3]=l,t[4]=n),n}let a;return t[5]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)(vo,{}),t[5]=a):a=t[5],a},vo=()=>{let t=(0,me.c)(86),e=Dt(ut),[r,a]=It(Ir),[l,s]=(0,h.useState)(""),[n,i]=(0,h.useState)(""),[c,d]=(0,h.useState)(),m=(0,h.useRef)(null),u=(0,h.useRef)(null),p=(0,h.useRef)(null),f=(0,h.useRef)(null),v=(0,h.useRef)(null),N=Vt(),{invokeAiTool:A}=Bt(),x=r==null?void 0:r.id,w;t[0]===(r==null?void 0:r.messages)?w=t[1]:(w=(r==null?void 0:r.messages)||[],t[0]=r==null?void 0:r.messages,t[1]=w);let _;t[2]===N?_=t[3]:(_=new or({api:N.getAiURL("chat").toString(),headers:N.headers(),prepareSendMessagesRequest:To}),t[2]=N,t[3]=_);let y;t[4]===e?y=t[5]:(y=b=>{let{messages:R}=b;e(L=>Fr({chatState:L,chatId:L.activeChatId,messages:R}))},t[4]=e,t[5]=y);let{messages:g,sendMessage:S,error:T,status:E,regenerate:j,stop:C,addToolResult:P,id:k}=$t({id:x,sendAutomaticallyWhen:Ao,messages:w,transport:_,onFinish:y,onToolCall:async b=>{let{toolCall:R}=b;await Qt({invokeAiTool:A,addToolResult:I,toolCall:{toolName:R.toolName,toolCallId:R.toolCallId,input:R.input}})},onError:Eo}),I=P,z;t[6]===Symbol.for("react.memo_cache_sentinel")?(z=b=>{if(b.length===0)return;let R=0;for(let L of b)R+=L.size;if(R>po){Jt({title:"File size exceeds 50MB limit",description:"Please remove some files and try again."});return}d(L=>[...L??[],...b])},t[6]=z):z=t[6];let O=$(z),W;t[7]===c?W=t[8]:(W=b=>{c&&d(c.filter(R=>R!==b))},t[7]=c,t[8]=W);let X=$(W),D=E==="submitted"||E==="streaming",H;t[9]!==D||t[10]!==g?(H=D&&g.length>0&&tr(g),t[9]=D,t[10]=g,t[11]=H):H=t[11];let ue=H,xe;t[12]===Symbol.for("react.memo_cache_sentinel")?(xe=()=>{requestAnimationFrame(()=>{if(p.current){let b=p.current;b.scrollTop=b.scrollHeight}})},t[12]=xe):xe=t[12];let ve;t[13]===x?ve=t[14]:(ve=[x],t[13]=x,t[14]=ve),(0,h.useEffect)(xe,ve);let ge;t[15]!==k||t[16]!==S||t[17]!==e?(ge=async(b,R)=>{let L=Date.now(),q={id:k,title:Kt(b),messages:[],createdAt:L,updatedAt:L};e(he=>{let Ze=new Map(he.chats);return Ze.set(q.id,q),{...he,chats:Ze,activeChatId:q.id}});let Ye=R&&R.length>0?await ot(R):void 0;S({role:"user",parts:[{type:"text",text:b},...Ye??[]]}),d(void 0),s("")},t[15]=k,t[16]=S,t[17]=e,t[18]=ge):ge=t[18];let ke=ge,be;t[19]===a?be=t[20]:(be=()=>{a(null),s(""),i(""),d(void 0)},t[19]=a,t[20]=be);let Me=$(be),we;t[21]!==g||t[22]!==S?(we=(b,R)=>{var he;let L=g[b],q=(he=L.parts)==null?void 0:he.filter(Po),Ye=L.id;S({messageId:Ye,role:"user",parts:[{type:"text",text:R},...q]})},t[21]=g,t[22]=S,t[23]=we):we=t[23];let pe=$(we),je;t[24]!==c||t[25]!==S?(je=async(b,R)=>{var q;if(!R.trim())return;(q=u.current)!=null&&q.view&&tt(u.current.view);let L=c?await ot(c):void 0;b==null||b.preventDefault(),S({text:R,files:L}),s(""),d(void 0)},t[24]=c,t[25]=S,t[26]=je):je=t[26];let Fe=$(je),ye;t[27]===j?ye=t[28]:(ye=()=>{j()},t[27]=j,t[28]=ye);let Oe=ye,Ne;t[29]!==ke||t[30]!==c||t[31]!==n?(Ne=()=>{var b;n.trim()&&((b=m.current)!=null&&b.view&&tt(m.current.view),ke(n.trim(),c))},t[29]=ke,t[30]=c,t[31]=n,t[32]=Ne):Ne=t[32];let We=$(Ne),Se;t[33]===Symbol.for("react.memo_cache_sentinel")?(Se=()=>{var b,R;return(R=(b=m.current)==null?void 0:b.editor)==null?void 0:R.blur()},t[33]=Se):Se=t[33];let zt=Se,M=g.length===0,Ce;t[34]!==Fe||t[35]!==We||t[36]!==l||t[37]!==D||t[38]!==M||t[39]!==n||t[40]!==O||t[41]!==C?(Ce=M?(0,o.jsx)(Qe,{placeholder:"Ask anything, @ to include context about tables or dataframes",input:n,inputRef:m,inputClassName:"px-1 py-0",setInput:i,onSubmit:We,isLoading:D,onStop:C,fileInputRef:f,onAddFiles:O,onClose:zt},"new-thread-input"):(0,o.jsx)(Qe,{input:l,setInput:s,onSubmit:Fe,inputRef:u,isLoading:D,onStop:C,onClose:()=>{var b,R;return(R=(b=u.current)==null?void 0:b.editor)==null?void 0:R.blur()},fileInputRef:f,onAddFiles:O}),t[34]=Fe,t[35]=We,t[36]=l,t[37]=D,t[38]=M,t[39]=n,t[40]=O,t[41]=C,t[42]=Ce):Ce=t[42];let G=Ce,_e;t[43]!==c||t[44]!==M||t[45]!==X?(_e=c&&c.length>0&&(0,o.jsx)("div",{className:V("flex flex-row gap-1 flex-wrap p-1",M&&"py-2 px-1"),children:c==null?void 0:c.map(b=>(0,o.jsx)(kr,{file:b,onRemove:()=>X(b)},b.name))}),t[43]=c,t[44]=M,t[45]=X,t[46]=_e):_e=t[46];let K=_e,He=r==null?void 0:r.id,Q;t[47]!==Me||t[48]!==a||t[49]!==He?(Q=(0,o.jsx)(nt,{children:(0,o.jsx)(ho,{onNewChat:Me,activeChatId:He,setActiveChat:a})}),t[47]=Me,t[48]=a,t[49]=He,t[50]=Q):Q=t[50];let Z;t[51]!==G||t[52]!==K||t[53]!==M?(Z=M&&(0,o.jsxs)("div",{className:"rounded-md border bg-background",children:[K,G]}),t[51]=G,t[52]=K,t[53]=M,t[54]=Z):Z=t[54];let ee;if(t[55]!==pe||t[56]!==ue||t[57]!==g){let b;t[59]!==pe||t[60]!==ue||t[61]!==g.length?(b=(R,L)=>(0,o.jsx)(Pt,{message:R,index:L,onEdit:pe,isStreamingReasoning:ue,isLast:L===g.length-1},R.id),t[59]=pe,t[60]=ue,t[61]=g.length,t[62]=b):b=t[62],ee=g.map(b),t[55]=pe,t[56]=ue,t[57]=g,t[58]=ee}else ee=t[58];let te;t[63]===D?te=t[64]:(te=D&&(0,o.jsx)("div",{className:"flex justify-center py-4",children:(0,o.jsx)(st,{className:"h-4 w-4 animate-spin"})}),t[63]=D,t[64]=te);let re;t[65]!==T||t[66]!==Oe?(re=T&&(0,o.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[(0,o.jsx)(Pr,{error:T}),(0,o.jsx)(U,{variant:"outline",size:"sm",onClick:Oe,children:"Retry"})]}),t[65]=T,t[66]=Oe,t[67]=re):re=t[67];let Re;t[68]===Symbol.for("react.memo_cache_sentinel")?(Re=(0,o.jsx)("div",{ref:v}),t[68]=Re):Re=t[68];let oe;t[69]!==Z||t[70]!==ee||t[71]!==te||t[72]!==re?(oe=(0,o.jsxs)("div",{className:"flex-1 px-3 bg-(--slate-1) gap-4 py-3 flex flex-col overflow-y-auto",ref:p,children:[Z,ee,te,re,Re]}),t[69]=Z,t[70]=ee,t[71]=te,t[72]=re,t[73]=oe):oe=t[73];let le;t[74]!==D||t[75]!==C?(le=D&&(0,o.jsx)("div",{className:"w-full flex justify-center items-center z-20 border-t",children:(0,o.jsx)(U,{variant:"linkDestructive",size:"sm",onClick:C,children:"Stop"})}),t[74]=D,t[75]=C,t[76]=le):le=t[76];let se;t[77]!==G||t[78]!==K||t[79]!==M?(se=!M&&(0,o.jsxs)(o.Fragment,{children:[K,G]}),t[77]=G,t[78]=K,t[79]=M,t[80]=se):se=t[80];let Ae;return t[81]!==Q||t[82]!==oe||t[83]!==le||t[84]!==se?(Ae=(0,o.jsxs)("div",{className:"flex flex-col h-[calc(100%-53px)]",children:[Q,oe,le,se]}),t[81]=Q,t[82]=oe,t[83]=le,t[84]=se,t[85]=Ae):Ae=t[85],Ae},go=xo;function bo(t){return t.type==="text"}function wo(t){return t.text}function jo(t){return t.type==="file"}function yo(t,e){return(0,o.jsx)(Mr,{attachment:t},e)}function No(){}function So(){}function Co(t){return t.type==="text"}function _o(t){return t.text}function Ro(t){return(0,o.jsx)(mr,{value:t.value,className:"text-xs",children:(0,o.jsxs)("div",{className:"flex flex-col",children:[t.label,(0,o.jsx)("div",{className:"text-muted-foreground text-xs pt-1 block",children:t.subtitle})]})},t.value)}function Ao(t){let{messages:e}=t;return rr(e)}async function To(t){let e=await er(t.messages);return{body:{tools:lr.getToolSchemas(),...t,...e}}}function Eo(t){ne.error("An error occurred:",t)}function Po(t){return t.type==="file"}export{go as default};
